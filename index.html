<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Gestor de Funcionários</title>
<style>
body {
    font-family: Arial;
    background: #f4f4f4;
    padding: 20px;
}
.container {
    background: white;
    padding: 20px;
    border-radius: 10px;
    max-width: 700px;
    margin: auto;
}
button {
    padding: 8px 12px;
    margin: 5px 0;
    cursor: pointer;
}
input {
    padding: 6px;
    margin: 5px 0;
}
.registro {
    border-bottom: 1px solid #ddd;
    padding: 5px 0;
}
.saldo {
    font-size: 20px;
    font-weight: bold;
}
.positivo { color: green; }
.negativo { color: red; }
.zero { color: black; }
</style>
</head>
<body>

<div class="container">
    <h2>Gestor de Funcionário</h2>

    <input type="text" id="nome" placeholder="Nome do Funcionário">
    <button onclick="criarFuncionario()">Criar Funcionário</button>

    <hr>

    <div id="areaFuncionario" style="display:none;">
        <h3 id="nomeFuncionario"></h3>
        <div class="saldo" id="saldo"></div>

        <button onclick="adicionarComissao()">Adicionar Comissão</button>
        <button onclick="registrarPagamento()">Registrar Pagamento</button>
        <button onclick="zerarConta()">Zerar Conta</button>

        <h4>Histórico</h4>
        <div id="historico"></div>
    </div>
</div>

<script>
let funcionario = JSON.parse(localStorage.getItem("funcionario")) || null;

function salvar() {
    localStorage.setItem("funcionario", JSON.stringify(funcionario));
}

function criarFuncionario() {
    const nome = document.getElementById("nome").value;
    if (!nome) return alert("Digite o nome");

    funcionario = {
        nome: nome,
        movimentacoes: []
    };

    salvar();
    render();
}

function adicionarComissao() {
    const valor = parseFloat(prompt("Digite o valor da comissão:"));
    if (!valor || valor <= 0) return;

    funcionario.movimentacoes.push({
        tipo: "Comissão",
        valor: valor,
        data: new Date().toLocaleDateString()
    });

    salvar();
    render();
}

function registrarPagamento() {
    const valor = parseFloat(prompt("Digite o valor do pagamento:"));
    if (!valor || valor <= 0) return;

    funcionario.movimentacoes.push({
        tipo: "Pagamento",
        valor: -valor,
        data: new Date().toLocaleDateString()
    });

    salvar();
    render();
}

function zerarConta() {
    const saldo = calcularSaldo();
    if (saldo === 0) {
        alert("Saldo já está zerado.");
        return;
    }

    if (!confirm(`Tem certeza que deseja zerar o saldo de R$ ${saldo.toFixed(2)}?`)) {
        return;
    }

    funcionario.movimentacoes.push({
        tipo: "Quitação Automática",
        valor: -saldo,
        data: new Date().toLocaleDateString()
    });

    salvar();
    render();
}

function excluirRegistro(index) {
    if (!confirm("Deseja excluir este registro?")) return;
    funcionario.movimentacoes.splice(index, 1);
    salvar();
    render();
}

function calcularSaldo() {
    return funcionario.movimentacoes.reduce((total, mov) => total + mov.valor, 0);
}

function render() {
    if (!funcionario) return;

    document.getElementById("areaFuncionario").style.display = "block";
    document.getElementById("nomeFuncionario").innerText = funcionario.nome;

    const saldo = calcularSaldo();
    const saldoDiv = document.getElementById("saldo");

    saldoDiv.innerText = "Saldo: R$ " + saldo.toFixed(2);

    saldoDiv.className = "saldo " + 
        (saldo > 0 ? "positivo" : saldo < 0 ? "negativo" : "zero");

    const historicoDiv = document.getElementById("historico");
    historicoDiv.innerHTML = "";

    funcionario.movimentacoes.forEach((mov, index) => {
        const div = document.createElement("div");
        div.className = "registro";
        div.innerHTML = `
            ${mov.data} - ${mov.tipo}: R$ ${mov.valor.toFixed(2)}
            <button onclick="excluirRegistro(${index})">Excluir</button>
        `;
        historicoDiv.appendChild(div);
    });
}

if (funcionario) render();
</script>

</body>
</html>
