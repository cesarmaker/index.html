<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Gestor Fora do radar</title>

<style>
body{
font-family:Arial;
background:#f4f6f9;
padding:20px;
margin:0;
}

h1{
text-align:center;
}

.card{
background:#fff;
padding:15px;
margin-bottom:20px;
border-radius:10px;
box-shadow:0 5px 15px rgba(0,0,0,0.1);
}

input,select,button{
padding:8px;
margin:5px 0;
width:100%;
}

button{
background:#007bff;
color:#fff;
border:none;
border-radius:5px;
cursor:pointer;
}

button:hover{
opacity:0.9;
}

.delete-btn{
background:red;
}

table{
width:100%;
border-collapse:collapse;
font-size:14px;
}

th,td{
border-bottom:1px solid #ddd;
padding:8px;
text-align:center;
}

th{
background:#007bff;
color:white;
}
</style>
</head>
<body>

<h1>Gestor de Funcionários</h1>

<div class="card">
<h3>Cadastrar Funcionário</h3>
<input type="text" id="nomeFuncionario" placeholder="Nome">
<button onclick="addFuncionario()">Adicionar</button>
</div>

<div class="card">
<h3>Registrar Movimento</h3>
<select id="funcionario"></select>
<select id="tipo">
<option value="Vale">Vale Dinheiro</option>
<option value="Consumo">Consumo Interno</option>
<option value="Adiantamento">Adiantamento</option>
</select>
<input type="number" id="valor" placeholder="Valor">
<input type="date" id="data">
<button onclick="addRegistro()">Registrar</button>
</div>

<div class="card">
<h3>Relatório Individual</h3>
<select id="relatorioFuncionario" onchange="gerarRelatorio()"></select>
<p id="relatorioResultado"></p>
</div>

<div class="card">
<h3>Registros</h3>
<table>
<thead>
<tr>
<th>Funcionário</th>
<th>Tipo</th>
<th>Valor</th>
<th>Data</th>
<th>Ação</th>
</tr>
</thead>
<tbody id="tabela"></tbody>
</table>
</div>

<script>

let funcionarios = JSON.parse(localStorage.getItem("funcionarios")) || [];
let registros = JSON.parse(localStorage.getItem("registros")) || [];

function salvar(){
localStorage.setItem("funcionarios",JSON.stringify(funcionarios));
localStorage.setItem("registros",JSON.stringify(registros));
}

function atualizarSelects(){
let select1 = document.getElementById("funcionario");
let select2 = document.getElementById("relatorioFuncionario");

select1.innerHTML="";
select2.innerHTML="";

funcionarios.forEach(f=>{
let opt1=document.createElement("option");
opt1.value=f;
opt1.textContent=f;
select1.appendChild(opt1);

let opt2=document.createElement("option");
opt2.value=f;
opt2.textContent=f;
select2.appendChild(opt2);
});
}

function addFuncionario(){
let nome=document.getElementById("nomeFuncionario").value;
if(!nome) return;
funcionarios.push(nome);
salvar();
atualizarSelects();
document.getElementById("nomeFuncionario").value="";
}

function addRegistro(){
let funcionario=document.getElementById("funcionario").value;
let tipo=document.getElementById("tipo").value;
let valor=parseFloat(document.getElementById("valor").value);
let data=document.getElementById("data").value;

if(!funcionario||!valor||!data) return;

registros.push({funcionario,tipo,valor,data});
salvar();
renderTabela();
gerarRelatorio();
document.getElementById("valor").value="";
}

function excluir(index){
registros.splice(index,1);
salvar();
renderTabela();
gerarRelatorio();
}

function renderTabela(){
let tbody=document.getElementById("tabela");
tbody.innerHTML="";

registros.forEach((r,i)=>{
let tr=document.createElement("tr");
tr.innerHTML=`
<td>${r.funcionario}</td>
<td>${r.tipo}</td>
<td>R$ ${r.valor.toFixed(2)}</td>
<td>${r.data}</td>
<td><button class="delete-btn" onclick="excluir(${i})">Excluir</button></td>
`;
tbody.appendChild(tr);
});
}

function gerarRelatorio(){
let funcionario=document.getElementById("relatorioFuncionario").value;
if(!funcionario) return;

let totalVale=0;
let totalConsumo=0;
let totalAdiantamento=0;

registros.forEach(r=>{
if(r.funcionario===funcionario){
if(r.tipo==="Vale") totalVale+=r.valor;
if(r.tipo==="Consumo") totalConsumo+=r.valor;
if(r.tipo==="Adiantamento") totalAdiantamento+=r.valor;
}
});

let totalGeral=totalVale+totalConsumo+totalAdiantamento;

document.getElementById("relatorioResultado").innerHTML=
`Vale: R$ ${totalVale.toFixed(2)}<br>
Consumo: R$ ${totalConsumo.toFixed(2)}<br>
Adiantamento: R$ ${totalAdiantamento.toFixed(2)}<br>
<strong>Total Devido: R$ ${totalGeral.toFixed(2)}</strong>`;
}

atualizarSelects();
renderTabela();

</script>

</body>
</html>
